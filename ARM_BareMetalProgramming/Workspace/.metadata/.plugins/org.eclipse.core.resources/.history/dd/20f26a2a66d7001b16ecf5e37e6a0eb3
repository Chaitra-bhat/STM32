/*
 * adc.c
 *
 *  Created on: Jun 27, 2021
 *      Author: Navjeevan
 */
#include<stm32f407xx.h>
#include<stdio.h>

#define ADC1_ENA	(1U<<8)
#define GPIOA_ENA	(1U<<0)
#define ADC_CH1		(1U<<0)
#define ADC_SEQ_LEN1 	0x00
#define ADC_CR2_ADON	(1U<<0)

void pa1_adc_init()
{
	//Enable clok
	RCC->AHB1ENR |= GPIOA_ENA;

	//Set mode to analog mode - PA1 (from datasheet)
	GPIOA->MODER |= (1U<<2);
	GPIOA->MODER |= (1U<<3);

	//Configure ADC peripheral

	//Configure clock for ADC module
	RCC->APB2ENR |= ADC1_ENA;

	//Configure ADC parameters
	ADC1->SQR3 = ADC_CH1;
	ADC1->SQR1 = ADC_SEQ_LEN1;
	ADC1->CR2 |= ADC_CR2_ADON;
}

void start_conversion()
{
	// start ADC conversion
}
