/*
 * systick.h
 *
 *  Created on: Dec 20, 2021
 *      Author: Navjeevan
 */

#ifndef SYSTICK_H_
#define SYSTICK_H_
#include<stm32f4xx.h>

#define SYSTICK_LOADVALUE		16000000
#define SYSTICK_CR				(1U<<0)
#define SYSTICK_CLK				(1U<<2)
#define SYSTICK_CNTFLG			(1U<<16)



void systick_delayMs(int delay)
{
	//configure systick
	//clocks per millisecond
	SysTick->LOAD = SYSTICK_LOADVALUE;

	// Clear the systick current value regsiter
	SysTick->VAL = 0;

	//Enable the systick and select general clock source
	SysTick->CTRL = SYSTICK_CR | SYSTICK_CLK;

	for (int i=0; i<delay;i++){

	//wait until counter flag is set
	while(!(SysTick->CTRL & SYSTICK_CNTFLG));
	}
	SysTick->CTRL = 0;
}



#endif /* SYSTICK_H_ */
